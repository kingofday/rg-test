"use strict";(self.webpackChunkregional_water=self.webpackChunkregional_water||[]).push([[176],{9176:function(e,n,i){i.r(n),i.d(n,{default:function(){return Z}});var t=i(6106),l=i(914),r=i(8993),o=i(177),u=i(5485),a=i(9530),d=i(2020),s=i(9439),c=i(458),f=i(543),v=i(184),m=function(e){e.data,e.form;var n,i,u,m=(0,d.$)().t,Z=(0,f.Z)({autoCallUrl:a.Z.roleManager.permissions,cachingLifeTimeInSeconds:3600}),h=(0,s.Z)(Z,3),p=h[1],g=h[2];return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(r.Z.Item,{noStyle:!0,name:"id",children:(0,v.jsx)(o.Z,{type:"hidden"})}),(0,v.jsxs)(t.Z,{gutter:16,children:[(0,v.jsx)(l.Z,{xs:24,sm:24,md:24,children:(0,v.jsx)(r.Z.Item,{name:"name",label:m("name"),rules:[{required:!0,message:null!==(n=m("required"))&&void 0!==n?n:""}],children:(0,v.jsx)(o.Z,{placeholder:null!==(i=m("name"))&&void 0!==i?i:""})})}),(0,v.jsx)(l.Z,{xs:24,sm:24,md:24,children:(0,v.jsx)(r.Z.Item,{name:"permissionIds",label:m("permissions"),rules:[{required:!0,message:null!==(u=m("required"))&&void 0!==u?u:""}],children:(0,v.jsx)(c.Z,{mode:"multiple",placeholder:m("permissions"),style:{width:"100%"},loading:p,options:null===g||void 0===g?void 0:g.map((function(e){return{label:e.name,value:e.id}}))})})})]})]})},Z=function(){var e,n=(0,d.$)().t;return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(u.Z,{title:n("roleManagement"),id:"role",idProp:"id",EntryForm:m,filterUrl:a.Z.roleManager.list,findUrl:function(e){return a.Z.roleManager.find(e.id)},columns:[{title:n("name"),dataIndex:"name",key:"name"}],scrollX:300,deleteAction:{url:function(e){return a.Z.roleManager.delete(e.id)}},addUrl:a.Z.roleManager.add,editAction:{url:a.Z.roleManager.update},children:(0,v.jsx)(t.Z,{gutter:[20,20],children:(0,v.jsx)(l.Z,{xs:24,sm:12,children:(0,v.jsx)(r.Z.Item,{name:"search",rules:[],children:(0,v.jsx)(o.Z,{style:{width:250},placeholder:null!==(e=n("search"))&&void 0!==e?e:""})})})})})})}},5485:function(e,n,i){i.d(n,{Z:function(){return P}});var t=i(4942),l=i(3433),r=i(1413),o=i(9439),u=i(4916),a=i(8993),d=i(7309),s=i(294),c=i(3099),f=i(4525),v=i(4021),m=i(4661),Z=i(5486),h=i(8467),p=i(2791),g=(0,p.createContext)({}),x=i(543),j=i(2020),y=i(502),b=i(5761),k=i(184),C=function(e){var n,i=(0,j.$)().t,t=(0,x.Z)({onSuccess:function(n){e.afterSelect(n)}}),l=(0,o.Z)(t,2),r=l[0],u=l[1];return(0,k.jsx)(d.Z,{loading:u,type:e.isMobile?"ghost":"primary",shape:e.isMobile?"default":"circle",icon:e.isMobile?void 0:(0,k.jsx)(m.Z,{size:e.isMobile?20:10,name:"IoPencilOutline"}),onClick:function(){if(e.findUrl){var n="string"===typeof e.findUrl?"".concat(e.findUrl,"?").concat(e.idProp,"=").concat(e.record[e.idProp]):e.findUrl(e.record);r.get(n)}else e.afterSelect(e.record)},title:null!==(n=i("edit"))&&void 0!==n?n:"",children:e.isMobile?i("edit"):null})},S=function(e){var n=a.Z.useForm(),i=(0,o.Z)(n,1)[0];return(0,k.jsx)(v.Z,{destroyOnClose:!0,open:!0,onCancel:e.onCancel,title:e.title,onOk:function(){i.submit()},okButtonProps:{loading:e.loading},width:e.entryModalWidth,children:(0,k.jsx)(a.Z,{id:"entry-form",layout:"vertical",form:i,initialValues:e.data||e.initialValues,onFinish:e.onEntrySubmit,autoComplete:"off",children:(0,k.jsx)(e.EntryForm,{form:i,initialValues:e.initialValues,data:e.data})})})},M=function(e){var n,i=(0,j.$)().t;return(0,k.jsx)(d.Z,{danger:!0,type:e.isMobile?"ghost":"primary",shape:e.isMobile?"default":"circle",icon:e.isMobile?void 0:(0,k.jsx)(m.Z,{size:e.isMobile?20:10,name:"IoTrashOutline"}),onClick:e.onClick,title:null!==(n=i("delete"))&&void 0!==n?n:"",children:e.isMobile?i("delete"):null})},w=u.Z.Panel,P=function(e){var n,i,P=e.id,z=e.title,E=e.columns,F=e.idProp,I=e.filterUrl,U=e.findUrl,V=e.addUrl,O=e.initialValues,N=e.disablePaging,A=e.EntryForm,W=e.children,$=e.deleteAction,q=e.editAction,B=e.pageSize,T=void 0===B?15:B,D=e.handleSubmit,K=void 0===D||D,L=e.customActions,R=e.buttons,X=e.scrollX,Y=void 0===X?"1500px":X,_=e.filtersHeight,H=e.scrollY,Q=e.entryModalWidth,G=e.enableRowNumber,J=void 0===G||G,ee=(0,j.$)().t,ne=a.Z.useForm(),ie=(0,o.Z)(ne,1)[0],te=(0,p.useState)(!1),le=(0,o.Z)(te,2),re=le[0],oe=le[1],ue=(0,p.useState)(!0),ae=(0,o.Z)(ue,2),de=ae[0],se=ae[1],ce=(0,p.useState)(null),fe=(0,o.Z)(ce,2),ve=fe[0],me=fe[1],Ze=(0,p.useState)(null),he=(0,o.Z)(Ze,2),pe=he[0],ge=he[1],xe=(0,p.useState)(E),je=(0,o.Z)(xe,2),ye=je[0],be=je[1],ke=(0,p.useState)({page:1,pageSize:T}),Ce=(0,o.Z)(ke,2),Se=Ce[0],Me=Ce[1],we=(0,p.useRef)(1),Pe=(0,x.Z)({initLoading:!0}),ze=(0,o.Z)(Pe,4),Ee=ze[0],Fe=ze[1],Ie=ze[2],Ue=ze[3],Ve=(0,x.Z)({onSuccess:function(e,n){Xe(n)}}),Oe=(0,o.Z)(Ve,2),Ne=Oe[0],Ae=Oe[1],We=(0,x.Z)({onSuccess:function(e,n){Ye(n?(0,r.Z)((0,r.Z)({},n),e):e)}}),$e=(0,o.Z)(We,2),qe=$e[0],Be=$e[1],Te=(0,x.Z)({onSuccess:function(e,n){var i=F,t=null===n||void 0===n?void 0:n[i];t&&Ue((function(e){var n;return(0,r.Z)((0,r.Z)({},e),{},{totalEntitiesCount:null!==(n=null===e||void 0===e?void 0:e.totalEntitiesCount)&&void 0!==n?n:0,results:null===e||void 0===e?void 0:e.results.filter((function(e){return e[i]!==t}))})})),ge(null)}}),De=(0,o.Z)(Te,2),Ke=De[0],Le=De[1],Re=(0,p.useMemo)((function(){return window.outerWidth<Z.Z.breakpoints.xl}),[]),Xe=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=F,t=null===e||void 0===e?void 0:e[i];t&&Ue((function(n){return(0,r.Z)((0,r.Z)({},n),{},{results:null===n||void 0===n?void 0:n.results.map((function(n){return n[i]===t?(0,r.Z)((0,r.Z)({},n),e):n}))})})),n&&oe(!1)},Ye=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=F,t=null===e||void 0===e?void 0:e[i];t&&Ue((function(n){var i,t;return(0,r.Z)((0,r.Z)({},n),{},{totalEntitiesCount:null!==(i=null===n||void 0===n?void 0:n.totalEntitiesCount)&&void 0!==i?i:1,results:[e].concat((0,l.Z)(null!==(t=null===n||void 0===n?void 0:n.results)&&void 0!==t?t:[]))})})),n&&oe(!1)},_e=function(e){me(e),oe(!0)},He=function(e){ge(e)},Qe=(0,p.useMemo)((function(){var e;if((!L||!L.length)&&!q&&!$)return null;var n=(null!==(e=null===L||void 0===L?void 0:L.length)&&void 0!==e?e:0)+(q?1:0)+($?1:0);return{title:(0,k.jsx)(m.Z,{name:"IoBuildOutline"}),align:"center",key:"actions",fixed:"right",width:Re?30:25*n+8*(n-1)+40,dataIndex:"actions",render:function(e,n,i){if(Re){var t=[];return q&&t.push({key:"edit",label:(0,k.jsx)(C,{findUrl:U,afterSelect:_e,idProp:F,record:n,isMobile:!0})}),$&&t.push({key:"delete",label:(0,k.jsx)(M,{isMobile:!0,onClick:function(){return He(n)}})}),null!==L&&void 0!==L&&L.length&&(t=t.concat(L.map((function(i,t){var l;return{key:"action-"+t,label:i.renderer?i.renderer(e,n,Ue,Re):(0,k.jsx)(d.Z,{type:Re?"ghost":"primary",shape:Re?"default":"circle",icon:(0,k.jsx)(m.Z,{size:Re?20:10,name:null!==(l=i.icon)&&void 0!==l?l:"BsDash"}),onClick:function(){var e;return null===(e=i.action)||void 0===e?void 0:e.call(i,n,Ue)}},t)}})))),(0,k.jsx)(s.Z,{menu:{items:t},children:(0,k.jsx)("a",{onClick:function(e){return e.preventDefault()},children:(0,k.jsx)(m.Z,{name:"FaEllipsisV"})})})}return(0,k.jsxs)(c.Z,{className:"actions",children:[!!q&&(0,k.jsx)(C,{findUrl:U,afterSelect:_e,idProp:F,record:n}),!!$&&(0,k.jsx)(M,{onClick:function(){return He(n)}}),!!L&&L.map((function(i,t){var l;return i.renderer?i.renderer(e,n,Ue):(0,k.jsx)(d.Z,{type:"primary",shape:"circle",icon:(0,k.jsx)(m.Z,{size:10,name:null!==(l=i.icon)&&void 0!==l?l:"BsDash"}),onClick:function(){var e;return null===(e=i.action)||void 0===e?void 0:e.call(i,n,Ue)}},t)}))]})}}}),[L]),Ge=function(e){e.stopPropagation(),me(null),oe(!0)},Je=function(e){Ee.get("".concat(I,"?").concat(h.Z.convertToQueryString((0,r.Z)((0,r.Z)({},Se),e)).toString()))},en=function(){me(null),oe(!1)};(0,p.useEffect)((function(){Je(ie.getFieldsValue())}),[]);var nn=(0,p.useMemo)((function(){var e=Qe?[].concat((0,l.Z)(ye.filter((function(e){return"rowNumber"!==e.key})).map((function(e){return(0,r.Z)((0,r.Z)({},e),{},{fixed:window.outerWidth<Z.Z.breakpoints.lg?void 0:e.fixed})}))),[Qe]):ye.filter((function(e){return"rowNumber"!==e.key}));return J&&e.unshift({key:"rowNumber",title:"#",width:80,fixed:window.outerWidth<Z.Z.breakpoints.lg?void 0:"left",render:function(e,n,i){return(0,k.jsx)("span",{children:(we.current-1)*Se.pageSize+i+1})}}),e}),[ye]);return(0,k.jsx)(g.Provider,{value:{form:ie},children:(0,k.jsxs)(b.Z,{id:P,title:z,className:"admin",children:[!Re&&!!V&&(0,k.jsx)("div",{children:(0,k.jsx)(d.Z,{icon:(0,k.jsx)(m.Z,{name:"IoAdd"}),onClick:Ge,type:"primary",size:"small",title:null!==(n=ee("add"))&&void 0!==n?n:"",children:(0,k.jsx)("small",{children:ee("add")})})}),(0,k.jsx)(u.Z,{defaultActiveKey:["filters"],onChange:function(){return se((function(e){return!e}))},children:(0,k.jsx)(w,{header:ee("filters"),extra:V&&Re?(0,k.jsx)(d.Z,{icon:(0,k.jsx)(m.Z,{name:"IoAdd"}),onClick:Ge,type:"primary",size:"small",title:null!==(i=ee("add"))&&void 0!==i?i:"",children:(0,k.jsx)("small",{children:ee("add")})}):null,children:(0,k.jsx)(a.Z,{name:"filters",form:ie,initialValues:O,onFinish:function(e){Me((function(e){return(0,r.Z)((0,r.Z)({},e),{},{page:1})})),we.current=1,(E.length!==ye.length||E.some((function(e){return!ye.map((function(e){return e.key})).includes(e.key)})))&&be(E),Je((0,r.Z)((0,r.Z)({},e),{},{page:1}))},autoComplete:"off",children:(0,k.jsxs)(c.Z,{direction:"horizontal",children:[W,(0,k.jsxs)(a.Z.Item,{className:"flex-row-end btns",children:[null===R||void 0===R?void 0:R.map((function(e){return(0,k.jsx)(d.Z,{type:"primary",htmlType:"button",style:e.style,className:e.className,onClick:function(n){return e.onClick(n,ie.getFieldsValue())},children:e.children})})),(0,k.jsx)(d.Z,{type:"primary",htmlType:"submit",children:ee("search")})]})]})})},"filters")}),(0,k.jsx)(f.Z,{loading:Fe,direction:"rtl",rowKey:F,columns:nn,dataSource:null===Ie?void 0:(0,l.Z)(Ie.results),onChange:function(e,n,i){var t,l,o,u;Me({page:null!==(t=e.current)&&void 0!==t?t:1,pageSize:null!==(l=e.pageSize)&&void 0!==l?l:15}),we.current=null!==(o=e.current)&&void 0!==o?o:1,Je((0,r.Z)((0,r.Z)({},ie.getFieldsValue()),{},{page:null!==(u=e.current)&&void 0!==u?u:1}))},scroll:{x:Y,y:H?H+(de?0:null!==_&&void 0!==_?_:0):H},pagination:N?void 0:{pageSize:Se.pageSize,current:Se.page,total:null===Ie||void 0===Ie?void 0:Ie.totalEntitiesCount}},"table-".concat(F)),!!A&&(K?re?(0,k.jsx)(S,{EntryForm:A,onCancel:en,onEntrySubmit:function(e){q&&ve?Ne.put(q.url,e):V&&!ve&&qe.post(V,e)},entryModalWidth:Q,title:ee(ve?"edit":"add"),data:null!==ve&&void 0!==ve?ve:void 0,initialValues:null!==O&&void 0!==O?O:void 0,loading:Be||Ae}):null:re?(0,k.jsx)(v.Z,{destroyOnClose:!0,open:!0,onCancel:en,title:ee(ve?"edit":"add"),footer:null,width:Q,children:(0,k.jsx)(A,{onCancel:function(){return oe(!1)},data:ve,onSuccess:ve?Xe:Ye})}):null),(0,k.jsx)(y.Z,{open:!!pe,loading:Le,onOk:function(){if(pe&&$){var e,n;if("string"!==typeof(null===$||void 0===$?void 0:$.url)&&~(null===$||void 0===$?void 0:$.url(pe).indexOf("?")))throw new Error("delete url cannot have query strings");var i="string"===typeof(null===$||void 0===$?void 0:$.url)?"".concat($.url):null===$||void 0===$?void 0:$.url(pe);Ke.delete(i,(0,t.Z)({},null!==(e=null===$||void 0===$?void 0:$.sendingProp)&&void 0!==e?e:F,pe[null!==(n=null===$||void 0===$?void 0:$.sendingProp)&&void 0!==n?n:F]))}},onCancel:function(){return ge(null)}})]})})}},502:function(e,n,i){var t=i(3655),l=i(4021),r=i(2020),o=i(184),u=t.Z.Paragraph;n.Z=function(e){var n=e.open,i=e.onOk,t=e.loading,a=e.onCancel,d=e.title,s=e.message,c=(0,r.$)().t;return(0,o.jsx)(l.Z,{title:null!==d&&void 0!==d?d:c("delete"),open:n,onOk:i,onCancel:a,okButtonProps:{danger:!0,loading:t},children:(0,o.jsx)(u,{children:s||c("areYouSure")})})}}}]);
//# sourceMappingURL=176.b93c26b3.chunk.js.map