"use strict";(self.webpackChunkregional_water=self.webpackChunkregional_water||[]).push([[176],{9176:function(e,n,i){i.r(n),i.d(n,{default:function(){return Z}});var t=i(6106),l=i(914),r=i(8993),o=i(177),u=i(5485),a=i(9530),d=i(2020),s=i(9439),c=i(458),f=i(543),v=i(184),m=function(e){e.data,e.form;var n,i,u,m=(0,d.$)().t,Z=(0,f.Z)({autoCallUrl:a.Z.roleManager.permissions,cachingLifeTimeInSeconds:3600}),p=(0,s.Z)(Z,3),h=p[1],g=p[2];return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(r.Z.Item,{noStyle:!0,name:"id",children:(0,v.jsx)(o.Z,{type:"hidden"})}),(0,v.jsxs)(t.Z,{gutter:16,children:[(0,v.jsx)(l.Z,{xs:24,sm:24,md:24,children:(0,v.jsx)(r.Z.Item,{name:"name",label:m("name"),rules:[{required:!0,message:null!==(n=m("required"))&&void 0!==n?n:""}],children:(0,v.jsx)(o.Z,{placeholder:null!==(i=m("name"))&&void 0!==i?i:""})})}),(0,v.jsx)(l.Z,{xs:24,sm:24,md:24,children:(0,v.jsx)(r.Z.Item,{name:"permissionIds",label:m("permissions"),rules:[{required:!0,message:null!==(u=m("required"))&&void 0!==u?u:""}],children:(0,v.jsx)(c.Z,{mode:"multiple",placeholder:m("permissions"),style:{width:"100%"},loading:h,options:null===g||void 0===g?void 0:g.map((function(e){return{label:e.name,value:e.id}}))})})})]})]})},Z=function(){var e,n=(0,d.$)().t;return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(u.Z,{title:n("roleManagement"),id:"role",idProp:"id",EntryForm:m,filterUrl:a.Z.roleManager.list,findUrl:function(e){return a.Z.roleManager.find(e.id)},columns:[{title:n("name"),dataIndex:"name",key:"name"}],scrollX:300,deleteAction:{url:function(e){return a.Z.roleManager.delete(e.id)}},addUrl:a.Z.roleManager.add,editAction:{url:a.Z.roleManager.update},children:(0,v.jsx)(t.Z,{gutter:[20,20],children:(0,v.jsx)(l.Z,{xs:24,sm:12,children:(0,v.jsx)(r.Z.Item,{name:"filter",rules:[],children:(0,v.jsx)(o.Z,{placeholder:null!==(e=n("search"))&&void 0!==e?e:""})})})})})})}},5485:function(e,n,i){i.d(n,{Z:function(){return P}});var t=i(4942),l=i(3433),r=i(1413),o=i(9439),u=i(4916),a=i(8993),d=i(7309),s=i(294),c=i(3099),f=i(4525),v=i(4021),m=i(2166),Z=i(5486),p=i(8467),h=i(2791),g=(0,h.createContext)({}),x=i(543),j=i(2020),y=i(502),b=i(5761),k=i(184),C=function(e){var n=(0,j.$)().t,i=(0,x.Z)({onSuccess:function(n){e.afterSelect(n)}}),t=(0,o.Z)(i,2),l=t[0],r=t[1];return(0,k.jsx)(d.Z,{loading:r,type:e.isMobile?"ghost":"primary",shape:e.isMobile?"default":"circle",icon:e.isMobile?void 0:(0,k.jsx)(m.Z,{size:e.isMobile?20:10,name:"IoPencilOutline"}),onClick:function(){if(e.findUrl){var n="string"===typeof e.findUrl?"".concat(e.findUrl,"?").concat(e.idProp,"=").concat(e.record[e.idProp]):e.findUrl(e.record);l.get(n)}else e.afterSelect(e.record)},children:e.isMobile?n("edit"):null})},S=function(e){var n=a.Z.useForm(),i=(0,o.Z)(n,1)[0];return(0,k.jsx)(v.Z,{destroyOnClose:!0,open:!0,onCancel:e.onCancel,title:e.title,onOk:function(){i.submit()},okButtonProps:{loading:e.loading},width:e.entryModalWidth,children:(0,k.jsx)(a.Z,{id:"entry-form",layout:"vertical",form:i,initialValues:e.initialValues,onFinish:e.onEntrySubmit,autoComplete:"off",children:(0,k.jsx)(e.EntryForm,{form:i,data:e.initialValues})})})},M=function(e){var n=(0,j.$)().t;return(0,k.jsx)(d.Z,{danger:!0,type:e.isMobile?"ghost":"primary",shape:e.isMobile?"default":"circle",icon:e.isMobile?void 0:(0,k.jsx)(m.Z,{size:e.isMobile?20:10,name:"IoTrashOutline"}),onClick:e.onClick,children:e.isMobile?n("delete"):null})},w=u.Z.Panel,P=function(e){var n,i=e.id,P=e.title,E=e.columns,F=e.idProp,I=e.filterUrl,U=e.findUrl,z=e.addUrl,O=e.initialValues,V=e.disablePaging,N=e.EntryForm,A=e.children,W=e.deleteAction,$=e.editAction,q=e.pageSize,B=void 0===q?15:q,T=e.handleSubmit,D=void 0===T||T,K=e.customActions,L=e.buttons,R=e.scrollX,X=void 0===R?"1500px":R,Y=e.filtersHeight,_=e.scrollY,H=e.entryModalWidth,Q=e.enableRowNumber,G=void 0===Q||Q,J=(0,j.$)().t,ee=a.Z.useForm(),ne=(0,o.Z)(ee,1)[0],ie=(0,h.useState)(!1),te=(0,o.Z)(ie,2),le=te[0],re=te[1],oe=(0,h.useState)(!0),ue=(0,o.Z)(oe,2),ae=ue[0],de=ue[1],se=(0,h.useState)(null),ce=(0,o.Z)(se,2),fe=ce[0],ve=ce[1],me=(0,h.useState)(null),Ze=(0,o.Z)(me,2),pe=Ze[0],he=Ze[1],ge=(0,h.useState)(E),xe=(0,o.Z)(ge,2),je=xe[0],ye=xe[1],be=(0,h.useState)({page:1,pageSize:B}),ke=(0,o.Z)(be,2),Ce=ke[0],Se=ke[1],Me=(0,h.useRef)(1),we=(0,x.Z)({initLoading:!0}),Pe=(0,o.Z)(we,4),Ee=Pe[0],Fe=Pe[1],Ie=Pe[2],Ue=Pe[3],ze=(0,x.Z)({onSuccess:function(e,n){Re(n)}}),Oe=(0,o.Z)(ze,2),Ve=Oe[0],Ne=Oe[1],Ae=(0,x.Z)({onSuccess:function(e){Xe(e)}}),We=(0,o.Z)(Ae,2),$e=We[0],qe=We[1],Be=(0,x.Z)({onSuccess:function(e,n){var i=F,t=null===n||void 0===n?void 0:n[i];t&&Ue((function(e){var n;return(0,r.Z)((0,r.Z)({},e),{},{totalEntitiesCount:null!==(n=null===e||void 0===e?void 0:e.totalEntitiesCount)&&void 0!==n?n:0,results:null===e||void 0===e?void 0:e.results.filter((function(e){return e[i]!==t}))})})),he(null)}}),Te=(0,o.Z)(Be,2),De=Te[0],Ke=Te[1],Le=(0,h.useMemo)((function(){return window.outerWidth<Z.Z.breakpoints.xl}),[]),Re=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=F,t=null===e||void 0===e?void 0:e[i];t&&Ue((function(n){return(0,r.Z)((0,r.Z)({},n),{},{results:null===n||void 0===n?void 0:n.results.map((function(n){return n[i]===t?(0,r.Z)((0,r.Z)({},n),e):n}))})})),n&&re(!1)},Xe=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=F,t=null===e||void 0===e?void 0:e[i];t&&Ue((function(n){var i,t;return(0,r.Z)((0,r.Z)({},n),{},{totalEntitiesCount:null!==(i=null===n||void 0===n?void 0:n.totalEntitiesCount)&&void 0!==i?i:1,results:[e].concat((0,l.Z)(null!==(t=null===n||void 0===n?void 0:n.results)&&void 0!==t?t:[]))})})),n&&re(!1)},Ye=function(e){ve(e),re(!0)},_e=function(e){he(e)},He=(0,h.useMemo)((function(){var e;if((!K||!K.length)&&!$&&!W)return null;var n=(null!==(e=null===K||void 0===K?void 0:K.length)&&void 0!==e?e:0)+($?1:0)+(W?1:0);return{title:(0,k.jsx)(m.Z,{name:"IoBuildOutline"}),align:"center",key:"actions",fixed:"right",width:Le?30:25*n+8*(n-1)+40,dataIndex:"actions",render:function(e,n,i){if(Le){var t=[];return $&&t.push({key:"edit",label:(0,k.jsx)(C,{findUrl:U,afterSelect:Ye,idProp:F,record:n,isMobile:!0})}),W&&t.push({key:"delete",label:(0,k.jsx)(M,{isMobile:!0,onClick:function(){return _e(n)}})}),null!==K&&void 0!==K&&K.length&&(t=t.concat(K.map((function(i,t){var l;return{key:"action-"+t,label:i.renderer?i.renderer(e,n,Ue,Le):(0,k.jsx)(d.Z,{type:Le?"ghost":"primary",shape:Le?"default":"circle",icon:(0,k.jsx)(m.Z,{size:Le?20:10,name:null!==(l=i.icon)&&void 0!==l?l:"BsDash"}),onClick:function(){var e;return null===(e=i.action)||void 0===e?void 0:e.call(i,n,Ue)}},t)}})))),(0,k.jsx)(s.Z,{menu:{items:t},children:(0,k.jsx)("a",{onClick:function(e){return e.preventDefault()},children:(0,k.jsx)(m.Z,{name:"FaEllipsisV"})})})}return(0,k.jsxs)(c.Z,{className:"actions",children:[!!$&&(0,k.jsx)(C,{findUrl:U,afterSelect:Ye,idProp:F,record:n}),!!W&&(0,k.jsx)(M,{onClick:function(){return _e(n)}}),!!K&&K.map((function(i,t){var l;return i.renderer?i.renderer(e,n,Ue):(0,k.jsx)(d.Z,{type:"primary",shape:"circle",icon:(0,k.jsx)(m.Z,{size:10,name:null!==(l=i.icon)&&void 0!==l?l:"BsDash"}),onClick:function(){var e;return null===(e=i.action)||void 0===e?void 0:e.call(i,n,Ue)}},t)}))]})}}}),[K]),Qe=function(e){Ee.get("".concat(I,"?").concat(p.Z.convertToQueryString((0,r.Z)((0,r.Z)({},Ce),e)).toString()))},Ge=function(){ve(null),re(!1)};(0,h.useEffect)((function(){Qe(ne.getFieldsValue())}),[]);var Je=(0,h.useMemo)((function(){var e=He?[].concat((0,l.Z)(je.filter((function(e){return"rowNumber"!==e.key})).map((function(e){return(0,r.Z)((0,r.Z)({},e),{},{fixed:window.outerWidth<Z.Z.breakpoints.lg?void 0:e.fixed})}))),[He]):je.filter((function(e){return"rowNumber"!==e.key}));return G&&e.unshift({key:"rowNumber",title:"#",width:80,fixed:window.outerWidth<Z.Z.breakpoints.lg?void 0:"left",render:function(e,n,i){return(0,k.jsx)("span",{children:(Me.current-1)*Ce.pageSize+i+1})}}),e}),[je]);return(0,k.jsx)(g.Provider,{value:{form:ne},children:(0,k.jsxs)(b.Z,{id:i,title:P,className:"admin",children:[(0,k.jsx)(u.Z,{defaultActiveKey:["filters"],onChange:function(){return de((function(e){return!e}))},children:(0,k.jsx)(w,{header:J("filters"),extra:z?(0,k.jsx)(d.Z,{icon:(0,k.jsx)(m.Z,{name:"IoAdd"}),onClick:function(e){e.stopPropagation(),ve(null),re(!0)},type:"primary",size:"small",title:null!==(n=J("add"))&&void 0!==n?n:"",children:(0,k.jsx)("small",{children:J("add")})}):null,children:(0,k.jsxs)(a.Z,{name:"filters",form:ne,initialValues:O,onFinish:function(e){Se((function(e){return(0,r.Z)((0,r.Z)({},e),{},{page:1})})),Me.current=1,(E.length!==je.length||E.some((function(e){return!je.map((function(e){return e.key})).includes(e.key)})))&&ye(E),Qe((0,r.Z)((0,r.Z)({},e),{},{page:1}))},autoComplete:"off",children:[A,(0,k.jsxs)(a.Z.Item,{className:"flex-row-end btns",children:[null===L||void 0===L?void 0:L.map((function(e){var n;return(0,k.jsx)(d.Z,{type:null!==(n="primary")?n:e.type,htmlType:"button",style:e.style,className:e.className,onClick:function(n){return e.onClick(n,ne.getFieldsValue())},children:e.children})})),(0,k.jsx)(d.Z,{type:"primary",htmlType:"submit",children:J("filter")})]})]})},"filters")}),(0,k.jsx)(f.Z,{loading:Fe,direction:"rtl",rowKey:F,columns:Je,dataSource:null===Ie?void 0:(0,l.Z)(Ie.results),onChange:function(e,n,i){var t,l,o,u;Se({page:null!==(t=e.current)&&void 0!==t?t:1,pageSize:null!==(l=e.pageSize)&&void 0!==l?l:15}),Me.current=null!==(o=e.current)&&void 0!==o?o:1,Qe((0,r.Z)((0,r.Z)({},ne.getFieldsValue()),{},{page:null!==(u=e.current)&&void 0!==u?u:1}))},scroll:{x:X,y:_?_+(ae?0:null!==Y&&void 0!==Y?Y:0):_},pagination:V?void 0:{pageSize:Ce.pageSize,current:Ce.page,total:null===Ie||void 0===Ie?void 0:Ie.totalEntitiesCount}},"table-".concat(F)),!!N&&(D?le?(0,k.jsx)(S,{EntryForm:N,onCancel:Ge,onEntrySubmit:function(e){$&&fe?Ve.put($.url,e):z&&!fe&&$e.post(z,e)},entryModalWidth:H,title:J(fe?"edit":"add"),initialValues:null!==fe&&void 0!==fe?fe:void 0,loading:qe||Ne}):null:le?(0,k.jsx)(v.Z,{destroyOnClose:!0,open:!0,onCancel:Ge,title:J(fe?"edit":"add"),footer:null,width:H,children:(0,k.jsx)(N,{onCancel:function(){return re(!1)},data:fe,onSuccess:fe?Re:Xe})}):null),(0,k.jsx)(y.Z,{open:!!pe,loading:Ke,onOk:function(){if(pe&&W){var e,n;if("string"!==typeof(null===W||void 0===W?void 0:W.url)&&~(null===W||void 0===W?void 0:W.url(pe).indexOf("?")))throw new Error("delete url cannot have query strings");var i="string"===typeof(null===W||void 0===W?void 0:W.url)?"".concat(W.url):null===W||void 0===W?void 0:W.url(pe);De.delete(i,(0,t.Z)({},null!==(e=null===W||void 0===W?void 0:W.sendingProp)&&void 0!==e?e:F,pe[null!==(n=null===W||void 0===W?void 0:W.sendingProp)&&void 0!==n?n:F]))}},onCancel:function(){return he(null)}})]})})}},502:function(e,n,i){var t=i(3655),l=i(4021),r=i(2020),o=i(184),u=t.Z.Paragraph;n.Z=function(e){var n=e.open,i=e.onOk,t=e.loading,a=e.onCancel,d=e.title,s=e.message,c=(0,r.$)().t;return(0,o.jsx)(l.Z,{title:null!==d&&void 0!==d?d:c("delete"),open:n,onOk:i,onCancel:a,okButtonProps:{danger:!0,loading:t},children:(0,o.jsx)(u,{children:s||c("areYouSure")})})}}}]);
//# sourceMappingURL=176.b28e00cf.chunk.js.map