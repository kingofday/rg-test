"use strict";(self.webpackChunkregional_water=self.webpackChunkregional_water||[]).push([[176],{9176:function(e,n,i){i.r(n),i.d(n,{default:function(){return Z}});var l=i(6106),t=i(914),r=i(8993),o=i(177),u=i(5485),a=i(9530),d=i(2020),s=i(9439),c=i(458),f=i(543),v=i(184),m=function(e){e.data,e.form;var n,i,u,m=(0,d.$)().t,Z=(0,f.Z)({autoCallUrl:a.Z.roleManager.permissions,cachingLifeTimeInSeconds:3600}),h=(0,s.Z)(Z,3),p=h[1],g=h[2];return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(r.Z.Item,{noStyle:!0,name:"id",children:(0,v.jsx)(o.Z,{type:"hidden"})}),(0,v.jsxs)(l.Z,{gutter:16,children:[(0,v.jsx)(t.Z,{xs:24,sm:24,md:24,children:(0,v.jsx)(r.Z.Item,{name:"name",label:m("name"),rules:[{required:!0,message:null!==(n=m("required"))&&void 0!==n?n:""}],children:(0,v.jsx)(o.Z,{placeholder:null!==(i=m("name"))&&void 0!==i?i:""})})}),(0,v.jsx)(t.Z,{xs:24,sm:24,md:24,children:(0,v.jsx)(r.Z.Item,{name:"permissionIds",label:m("permissions"),rules:[{required:!0,message:null!==(u=m("required"))&&void 0!==u?u:""}],children:(0,v.jsx)(c.Z,{mode:"multiple",placeholder:m("permissions"),style:{width:"100%"},loading:p,options:null===g||void 0===g?void 0:g.map((function(e){return{label:e.name,value:e.id}}))})})})]})]})},Z=function(){var e,n=(0,d.$)().t;return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(u.Z,{title:n("roleManagement"),id:"role",idProp:"id",EntryForm:m,filterUrl:a.Z.roleManager.list,findUrl:function(e){return a.Z.roleManager.find(e.id)},columns:[{title:n("name"),dataIndex:"name",key:"name"}],scrollX:300,deleteAction:{url:function(e){return a.Z.roleManager.delete(e.id)}},addUrl:a.Z.roleManager.add,editAction:{url:a.Z.roleManager.update},children:(0,v.jsx)(l.Z,{gutter:[20,20],children:(0,v.jsx)(t.Z,{xs:24,sm:12,children:(0,v.jsx)(r.Z.Item,{name:"search",rules:[],children:(0,v.jsx)(o.Z,{placeholder:null!==(e=n("search"))&&void 0!==e?e:""})})})})})})}},5485:function(e,n,i){i.d(n,{Z:function(){return P}});var l=i(4942),t=i(3433),r=i(1413),o=i(9439),u=i(4916),a=i(8993),d=i(7309),s=i(294),c=i(3099),f=i(4525),v=i(4021),m=i(4661),Z=i(5486),h=i(8467),p=i(2791),g=(0,p.createContext)({}),x=i(543),j=i(2020),y=i(502),b=i(5761),k=i(184),C=function(e){var n,i=(0,j.$)().t,l=(0,x.Z)({onSuccess:function(n){e.afterSelect(n)}}),t=(0,o.Z)(l,2),r=t[0],u=t[1];return(0,k.jsx)(d.Z,{loading:u,type:e.isMobile?"ghost":"primary",shape:e.isMobile?"default":"circle",icon:e.isMobile?void 0:(0,k.jsx)(m.Z,{size:e.isMobile?20:10,name:"IoPencilOutline"}),onClick:function(){if(e.findUrl){var n="string"===typeof e.findUrl?"".concat(e.findUrl,"?").concat(e.idProp,"=").concat(e.record[e.idProp]):e.findUrl(e.record);r.get(n)}else e.afterSelect(e.record)},title:null!==(n=i("edit"))&&void 0!==n?n:"",children:e.isMobile?i("edit"):null})},S=function(e){var n=a.Z.useForm(),i=(0,o.Z)(n,1)[0];return(0,k.jsx)(v.Z,{destroyOnClose:!0,open:!0,onCancel:e.onCancel,title:e.title,onOk:function(){i.submit()},okButtonProps:{loading:e.loading},width:e.entryModalWidth,children:(0,k.jsx)(a.Z,{id:"entry-form",layout:"vertical",form:i,initialValues:e.initialValues,onFinish:e.onEntrySubmit,autoComplete:"off",children:(0,k.jsx)(e.EntryForm,{form:i,data:e.initialValues})})})},M=function(e){var n,i=(0,j.$)().t;return(0,k.jsx)(d.Z,{danger:!0,type:e.isMobile?"ghost":"primary",shape:e.isMobile?"default":"circle",icon:e.isMobile?void 0:(0,k.jsx)(m.Z,{size:e.isMobile?20:10,name:"IoTrashOutline"}),onClick:e.onClick,title:null!==(n=i("delete"))&&void 0!==n?n:"",children:e.isMobile?i("delete"):null})},w=u.Z.Panel,P=function(e){var n,i,P,z=e.id,E=e.title,F=e.columns,I=e.idProp,U=e.filterUrl,O=e.findUrl,V=e.addUrl,N=e.initialValues,A=e.disablePaging,W=e.EntryForm,$=e.children,q=e.deleteAction,B=e.editAction,T=e.pageSize,D=void 0===T?15:T,K=e.handleSubmit,L=void 0===K||K,R=e.customActions,X=e.buttons,Y=e.scrollX,_=void 0===Y?"1500px":Y,H=e.filtersHeight,Q=e.scrollY,G=e.entryModalWidth,J=e.enableRowNumber,ee=void 0===J||J,ne=(0,j.$)().t,ie=a.Z.useForm(),le=(0,o.Z)(ie,1)[0],te=(0,p.useState)(!1),re=(0,o.Z)(te,2),oe=re[0],ue=re[1],ae=(0,p.useState)(!0),de=(0,o.Z)(ae,2),se=de[0],ce=de[1],fe=(0,p.useState)(null),ve=(0,o.Z)(fe,2),me=ve[0],Ze=ve[1],he=(0,p.useState)(null),pe=(0,o.Z)(he,2),ge=pe[0],xe=pe[1],je=(0,p.useState)(F),ye=(0,o.Z)(je,2),be=ye[0],ke=ye[1],Ce=(0,p.useState)({page:1,pageSize:D}),Se=(0,o.Z)(Ce,2),Me=Se[0],we=Se[1],Pe=(0,p.useRef)(1),ze=(0,x.Z)({initLoading:!0}),Ee=(0,o.Z)(ze,4),Fe=Ee[0],Ie=Ee[1],Ue=Ee[2],Oe=Ee[3],Ve=(0,x.Z)({onSuccess:function(e,n){Ye(n)}}),Ne=(0,o.Z)(Ve,2),Ae=Ne[0],We=Ne[1],$e=(0,x.Z)({onSuccess:function(e,n){_e(n?(0,r.Z)((0,r.Z)({},n),e):e)}}),qe=(0,o.Z)($e,2),Be=qe[0],Te=qe[1],De=(0,x.Z)({onSuccess:function(e,n){var i=I,l=null===n||void 0===n?void 0:n[i];l&&Oe((function(e){var n;return(0,r.Z)((0,r.Z)({},e),{},{totalEntitiesCount:null!==(n=null===e||void 0===e?void 0:e.totalEntitiesCount)&&void 0!==n?n:0,results:null===e||void 0===e?void 0:e.results.filter((function(e){return e[i]!==l}))})})),xe(null)}}),Ke=(0,o.Z)(De,2),Le=Ke[0],Re=Ke[1],Xe=(0,p.useMemo)((function(){return window.outerWidth<Z.Z.breakpoints.xl}),[]),Ye=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=I,l=null===e||void 0===e?void 0:e[i];l&&Oe((function(n){return(0,r.Z)((0,r.Z)({},n),{},{results:null===n||void 0===n?void 0:n.results.map((function(n){return n[i]===l?(0,r.Z)((0,r.Z)({},n),e):n}))})})),n&&ue(!1)},_e=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=I,l=null===e||void 0===e?void 0:e[i];l&&Oe((function(n){var i,l;return(0,r.Z)((0,r.Z)({},n),{},{totalEntitiesCount:null!==(i=null===n||void 0===n?void 0:n.totalEntitiesCount)&&void 0!==i?i:1,results:[e].concat((0,t.Z)(null!==(l=null===n||void 0===n?void 0:n.results)&&void 0!==l?l:[]))})})),n&&ue(!1)},He=function(e){Ze(e),ue(!0)},Qe=function(e){xe(e)},Ge=(0,p.useMemo)((function(){var e;if((!R||!R.length)&&!B&&!q)return null;var n=(null!==(e=null===R||void 0===R?void 0:R.length)&&void 0!==e?e:0)+(B?1:0)+(q?1:0);return{title:(0,k.jsx)(m.Z,{name:"IoBuildOutline"}),align:"center",key:"actions",fixed:"right",width:Xe?30:25*n+8*(n-1)+40,dataIndex:"actions",render:function(e,n,i){if(Xe){var l=[];return B&&l.push({key:"edit",label:(0,k.jsx)(C,{findUrl:O,afterSelect:He,idProp:I,record:n,isMobile:!0})}),q&&l.push({key:"delete",label:(0,k.jsx)(M,{isMobile:!0,onClick:function(){return Qe(n)}})}),null!==R&&void 0!==R&&R.length&&(l=l.concat(R.map((function(i,l){var t;return{key:"action-"+l,label:i.renderer?i.renderer(e,n,Oe,Xe):(0,k.jsx)(d.Z,{type:Xe?"ghost":"primary",shape:Xe?"default":"circle",icon:(0,k.jsx)(m.Z,{size:Xe?20:10,name:null!==(t=i.icon)&&void 0!==t?t:"BsDash"}),onClick:function(){var e;return null===(e=i.action)||void 0===e?void 0:e.call(i,n,Oe)}},l)}})))),(0,k.jsx)(s.Z,{menu:{items:l},children:(0,k.jsx)("a",{onClick:function(e){return e.preventDefault()},children:(0,k.jsx)(m.Z,{name:"FaEllipsisV"})})})}return(0,k.jsxs)(c.Z,{className:"actions",children:[!!B&&(0,k.jsx)(C,{findUrl:O,afterSelect:He,idProp:I,record:n}),!!q&&(0,k.jsx)(M,{onClick:function(){return Qe(n)}}),!!R&&R.map((function(i,l){var t;return i.renderer?i.renderer(e,n,Oe):(0,k.jsx)(d.Z,{type:"primary",shape:"circle",icon:(0,k.jsx)(m.Z,{size:10,name:null!==(t=i.icon)&&void 0!==t?t:"BsDash"}),onClick:function(){var e;return null===(e=i.action)||void 0===e?void 0:e.call(i,n,Oe)}},l)}))]})}}}),[R]),Je=function(e){e.stopPropagation(),Ze(null),ue(!0)},en=function(e){Fe.get("".concat(U,"?").concat(h.Z.convertToQueryString((0,r.Z)((0,r.Z)({},Me),e)).toString()))},nn=function(){Ze(null),ue(!1)};(0,p.useEffect)((function(){en(le.getFieldsValue())}),[]);var ln=(0,p.useMemo)((function(){var e=Ge?[].concat((0,t.Z)(be.filter((function(e){return"rowNumber"!==e.key})).map((function(e){return(0,r.Z)((0,r.Z)({},e),{},{fixed:window.outerWidth<Z.Z.breakpoints.lg?void 0:e.fixed})}))),[Ge]):be.filter((function(e){return"rowNumber"!==e.key}));return ee&&e.unshift({key:"rowNumber",title:"#",width:80,fixed:window.outerWidth<Z.Z.breakpoints.lg?void 0:"left",render:function(e,n,i){return(0,k.jsx)("span",{children:(Pe.current-1)*Me.pageSize+i+1})}}),e}),[be]);return(0,k.jsx)(g.Provider,{value:{form:le},children:(0,k.jsxs)(b.Z,{id:z,title:E,className:"admin",children:[!Xe&&!!V&&(0,k.jsx)("div",{children:(0,k.jsx)(d.Z,{icon:(0,k.jsx)(m.Z,{name:"IoAdd"}),onClick:Je,type:"primary",size:"small",title:null!==(n=ne("add"))&&void 0!==n?n:"",children:(0,k.jsx)("small",{children:ne("add")})})}),(0,k.jsx)(u.Z,{defaultActiveKey:["filters"],onChange:function(){return ce((function(e){return!e}))},children:(0,k.jsx)(w,{header:ne("filters"),extra:V&&Xe?(0,k.jsx)(d.Z,{icon:(0,k.jsx)(m.Z,{name:"IoAdd"}),onClick:Je,type:"primary",size:"small",title:null!==(i=ne("add"))&&void 0!==i?i:"",children:(0,k.jsx)("small",{children:ne("add")})}):null,children:(0,k.jsx)(a.Z,{name:"filters",form:le,initialValues:N,onFinish:function(e){we((function(e){return(0,r.Z)((0,r.Z)({},e),{},{page:1})})),Pe.current=1,(F.length!==be.length||F.some((function(e){return!be.map((function(e){return e.key})).includes(e.key)})))&&ke(F),en((0,r.Z)((0,r.Z)({},e),{},{page:1}))},autoComplete:"off",children:(0,k.jsxs)(c.Z,{direction:"horizontal",children:[$,(0,k.jsxs)(a.Z.Item,{className:"flex-row-end btns",children:[null===X||void 0===X?void 0:X.map((function(e){return(0,k.jsx)(d.Z,{type:"primary",htmlType:"button",style:e.style,className:e.className,onClick:function(n){return e.onClick(n,le.getFieldsValue())},children:e.children})})),(0,k.jsx)(d.Z,{type:"primary",htmlType:"submit",children:ne("search")})]})]})})},"filters")}),(0,k.jsx)(f.Z,{loading:Ie,direction:"rtl",rowKey:I,columns:ln,dataSource:null===Ue?void 0:(0,t.Z)(Ue.results),onChange:function(e,n,i){var l,t,o,u;we({page:null!==(l=e.current)&&void 0!==l?l:1,pageSize:null!==(t=e.pageSize)&&void 0!==t?t:15}),Pe.current=null!==(o=e.current)&&void 0!==o?o:1,en((0,r.Z)((0,r.Z)({},le.getFieldsValue()),{},{page:null!==(u=e.current)&&void 0!==u?u:1}))},scroll:{x:_,y:Q?Q+(se?0:null!==H&&void 0!==H?H:0):Q},pagination:A?void 0:{pageSize:Me.pageSize,current:Me.page,total:null===Ue||void 0===Ue?void 0:Ue.totalEntitiesCount}},"table-".concat(I)),!!W&&(L?oe?(0,k.jsx)(S,{EntryForm:W,onCancel:nn,onEntrySubmit:function(e){B&&me?Ae.put(B.url,e):V&&!me&&Be.post(V,e)},entryModalWidth:G,title:ne(me?"edit":"add"),initialValues:null!==(P=null!==me&&void 0!==me?me:N)&&void 0!==P?P:void 0,loading:Te||We}):null:oe?(0,k.jsx)(v.Z,{destroyOnClose:!0,open:!0,onCancel:nn,title:ne(me?"edit":"add"),footer:null,width:G,children:(0,k.jsx)(W,{onCancel:function(){return ue(!1)},data:me,onSuccess:me?Ye:_e})}):null),(0,k.jsx)(y.Z,{open:!!ge,loading:Re,onOk:function(){if(ge&&q){var e,n;if("string"!==typeof(null===q||void 0===q?void 0:q.url)&&~(null===q||void 0===q?void 0:q.url(ge).indexOf("?")))throw new Error("delete url cannot have query strings");var i="string"===typeof(null===q||void 0===q?void 0:q.url)?"".concat(q.url):null===q||void 0===q?void 0:q.url(ge);Le.delete(i,(0,l.Z)({},null!==(e=null===q||void 0===q?void 0:q.sendingProp)&&void 0!==e?e:I,ge[null!==(n=null===q||void 0===q?void 0:q.sendingProp)&&void 0!==n?n:I]))}},onCancel:function(){return xe(null)}})]})})}},502:function(e,n,i){var l=i(3655),t=i(4021),r=i(2020),o=i(184),u=l.Z.Paragraph;n.Z=function(e){var n=e.open,i=e.onOk,l=e.loading,a=e.onCancel,d=e.title,s=e.message,c=(0,r.$)().t;return(0,o.jsx)(t.Z,{title:null!==d&&void 0!==d?d:c("delete"),open:n,onOk:i,onCancel:a,okButtonProps:{danger:!0,loading:l},children:(0,o.jsx)(u,{children:s||c("areYouSure")})})}}}]);
//# sourceMappingURL=176.cc237358.chunk.js.map