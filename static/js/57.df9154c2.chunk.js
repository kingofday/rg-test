"use strict";(self.webpackChunkregional_water=self.webpackChunkregional_water||[]).push([[57],{7057:function(e,r,n){n.r(r),n.d(r,{default:function(){return S}});var l=n(3433),a=n(1413),s=n(9439),o=n(7309),i=n(6106),d=n(914),t=n(8993),u=n(177),m=n(5485),c=n(502),h=n(2166),x=n(9530),Z=n(543),p=n(2791),v=n(2020),f=n(6129),j=n(2014),g=n(458),w=n(7097),b=n(8467),I=n(184),y=function(e){var r,n=(0,v.$)().t,l=e.form||t.Z,a=(0,p.useMemo)((function(){var r,l=[];return e.notRequired||l.push({required:!0,message:null!==(r=n("required"))&&void 0!==r?r:""}),"undefined"!==typeof e.min&&l.push({validator:function(r,l,a){return l&&parseFloat(l)<e.min?Promise.reject(new Error(null!==(s=n("minAmountIsX",{amount:b.Z.commaThousondSeperator(e.min)}))&&void 0!==s?s:"")):Promise.resolve();var s}}),"undefined"!==typeof e.max&&l.push({validator:function(r,l,a){return l&&parseFloat(l)>e.max?Promise.reject(new Error(null!==(s=n("maxAmountIsX",{amount:b.Z.commaThousondSeperator(e.max)}))&&void 0!==s?s:"")):Promise.resolve();var s}}),l}),[e.notRequired,e.min,e.max]);return(0,I.jsx)(l.Item,{name:e.name||"amount",label:e.label||n("amount"),rules:a,children:(0,I.jsx)(w.Z,{readOnly:e.readOnly,stringMode:e.stringMode,formatter:function(e){return"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return parseFloat(e.replace(/\$\s?|(,*)/g,""))},placeholder:e.placeholder,className:"ltr-elm placeholder-r w-100 ".concat(e.className),controls:!1,style:{paddingRight:11},prefix:null!==(r=n("baseCurrency"))&&void 0!==r?r:e.unit})})},P=n(3447),C=n(2580),N=function(e){var r,n,l,o,m,c,h,p,f,w,b,N,q,k,S,M,F,E,A,L,z,O,T=e.data,U=e.form,$=(0,v.$)().t,R=(0,Z.Z)({autoCallUrl:x.Z.userManager.roles,cachingLifeTimeInSeconds:60}),V=(0,s.Z)(R,3),X=V[1],B=V[2],Y=(0,Z.Z)({autoCallUrl:x.Z.organizationLevel.tree,cachingLifeTimeInSeconds:60,mapper:function(e){var r=[];return e&&function e(n){n.nodes&&n.nodes.length?n.nodes.forEach((function(r){return e((0,a.Z)((0,a.Z)({},r),{},{name:"".concat(n.name,"/").concat(r.name)}))})):r.push(n)}(e),r}}),_=(0,s.Z)(Y,3),D=_[1],W=_[2];return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(t.Z.Item,{noStyle:!0,name:"id",children:(0,I.jsx)(u.Z,{type:"hidden"})}),(0,I.jsxs)(i.Z,{gutter:16,children:[(0,I.jsx)(d.Z,{xs:12,sm:8,md:6,children:(0,I.jsx)(t.Z.Item,{name:"firstName",label:$("firstName"),rules:[{required:!0,message:null!==(r=$("required"))&&void 0!==r?r:""}],children:(0,I.jsx)(u.Z,{placeholder:null!==(n=$("firstName"))&&void 0!==n?n:""})})}),(0,I.jsx)(d.Z,{xs:12,sm:8,md:6,children:(0,I.jsx)(t.Z.Item,{name:"lastName",label:$("lastName"),rules:[{required:!0,message:null!==(l=$("required"))&&void 0!==l?l:""}],children:(0,I.jsx)(u.Z,{placeholder:null!==(o=$("lastName"))&&void 0!==o?o:""})})}),(0,I.jsx)(d.Z,{xs:12,sm:8,md:6,children:(0,I.jsx)(t.Z.Item,{name:"nationalCode",label:$("nationalCode"),rules:[{required:!0,message:null!==(m=$("required"))&&void 0!==m?m:""},{pattern:P.Z.nationalCode,message:null!==(c=$("wrongFormat"))&&void 0!==c?c:""}],children:(0,I.jsx)(u.Z,{readOnly:!!T,placeholder:null!==(h=$("nationalCode"))&&void 0!==h?h:"",className:"ltr-elm placeholder-r"})})}),(0,I.jsx)(d.Z,{xs:12,sm:8,md:6,children:(0,I.jsx)(t.Z.Item,{valuePropName:"checked",name:"isEnabled",label:" ",children:(0,I.jsx)(j.Z,{children:$("isEnabled")})})}),!T&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(d.Z,{xs:12,sm:8,md:6,children:(0,I.jsx)(t.Z.Item,{name:"password",label:$("password"),rules:[{required:!0,message:null!==(p=$("required"))&&void 0!==p?p:""},{min:8,message:null!==(f=$("atleastXChar",{x:8}))&&void 0!==f?f:""}],children:(0,I.jsx)(u.Z.Password,{placeholder:null!==(w=$("password"))&&void 0!==w?w:"",className:"ltr-elm placeholder-r"})})}),(0,I.jsx)(d.Z,{xs:12,sm:8,md:6,children:(0,I.jsx)(t.Z.Item,{name:"passwordConfirm",label:$("confirmPassword"),rules:[{required:!0,message:null!==(b=$("required"))&&void 0!==b?b:""},function(e){var r=e.getFieldValue;return{validator:function(e,n){var l;return r("password")===n?Promise.resolve():Promise.reject(new Error(null!==(l=$("passwordsMissMatch"))&&void 0!==l?l:""))}}}],children:(0,I.jsx)(u.Z.Password,{placeholder:null!==(N=$("confirmPassword"))&&void 0!==N?N:"",className:"ltr-elm  placeholder-r"})})})]}),(0,I.jsx)(d.Z,{xs:12,sm:8,md:6,children:(0,I.jsx)(t.Z.Item,{name:"personnelId",label:$("personnelId"),rules:[{required:!0,message:null!==(q=$("required"))&&void 0!==q?q:""},{pattern:P.Z.personelId,message:null!==(k=$("wrongFormat"))&&void 0!==k?k:""}],children:(0,I.jsx)(u.Z,{placeholder:null!==(S=$("personnelId"))&&void 0!==S?S:"",className:"ltr-elm placeholder-r"})})}),(0,I.jsx)(d.Z,{xs:12,sm:8,md:6,children:(0,I.jsx)(t.Z.Item,{name:"phoneNumber",label:$("mobileNumber"),rules:[{required:!0,message:null!==(M=$("required"))&&void 0!==M?M:""},{pattern:P.Z.mobile,message:null!==(F=$("wrongFormat"))&&void 0!==F?F:""}],children:(0,I.jsx)(u.Z,{placeholder:null!==(E=$("mobileNumber"))&&void 0!==E?E:"",className:"ltr-elm placeholder-r"})})}),(0,I.jsx)(d.Z,{xs:12,sm:8,md:6,children:(0,I.jsx)(y,{stringMode:!1,name:"baseSalary",label:null!==(A=$("baseSalary"))&&void 0!==A?A:"",placeholder:null!==(L=$("baseSalary"))&&void 0!==L?L:""})}),(0,I.jsx)(d.Z,{xs:12,sm:8,md:6,children:(0,I.jsx)(t.Z.Item,{name:"emailAddress",label:$("email"),rules:[{pattern:P.Z.email,message:null!==(z=$("wrongFormat"))&&void 0!==z?z:""}],children:(0,I.jsx)(u.Z,{placeholder:null!==(O=$("email"))&&void 0!==O?O:"",className:"ltr-elm placeholder-r"})})}),(0,I.jsx)(d.Z,{xs:24,sm:8,md:6,children:(0,I.jsx)(t.Z.Item,{name:"organizationLevelId",label:$("organizationLevel"),children:(0,I.jsx)(g.Z,{allowClear:!0,placeholder:$("organizationLevel"),options:null===W||void 0===W?void 0:W.map((function(e){return{label:e.name,value:e.id}})),loading:D})})}),(0,I.jsx)(d.Z,{xs:12,sm:8,md:6,children:(0,I.jsx)(t.Z.Item,{name:"roleIds",label:$("roles"),children:(0,I.jsx)(g.Z,{mode:"multiple",loading:X,placeholder:$("roles"),defaultValue:[],showArrow:!0,style:{width:"100%"},options:null===B||void 0===B?void 0:B.map((function(e){return{label:e.name,value:e.id}}))})})}),(0,I.jsx)(C.Z,{data:T,entryFrm:U})]})]})},q=n(4021),k=function(e){var r,n,l,a,o=(0,Z.Z)({onSuccess:function(){e.onClose()}}),m=(0,s.Z)(o,2),c=m[0],h=m[1],p=(0,v.$)().t,f=t.Z.useForm(),j=(0,s.Z)(f,1)[0];return(0,I.jsx)(q.Z,{title:p("resetPassword"),open:!0,onCancel:e.onClose,onOk:function(){j.submit()},okButtonProps:{loading:h},children:(0,I.jsxs)(t.Z,{layout:"vertical",onFinish:function(e){c.post(x.Z.userManager.resetPassword,e)},onFinishFailed:function(){},autoComplete:"off",form:j,initialValues:e.data,children:[(0,I.jsx)(t.Z.Item,{noStyle:!0,name:"id",children:(0,I.jsx)(u.Z,{type:"hidden"})}),(0,I.jsxs)(i.Z,{gutter:16,children:[(0,I.jsx)(d.Z,{xs:24,sm:24,children:(0,I.jsx)(t.Z.Item,{name:"newPassword",label:p("newPassword"),rules:[{required:!0,message:null!==(r=p("required"))&&void 0!==r?r:""}],children:(0,I.jsx)(u.Z.Password,{placeholder:null!==(n=p("newPassword"))&&void 0!==n?n:""})})}),(0,I.jsx)(d.Z,{xs:24,sm:24,children:(0,I.jsx)(t.Z.Item,{name:"passwordConfirm",label:p("repeatPassword"),rules:[{required:!0,message:null!==(l=p("required"))&&void 0!==l?l:""},function(e){var r=e.getFieldValue;return{validator:function(e,n){var l;return r("newPassword")===n?Promise.resolve():Promise.reject(new Error(null!==(l=p("passwordsMissMatch"))&&void 0!==l?l:""))}}}],children:(0,I.jsx)(u.Z.Password,{placeholder:null!==(a=p("repeatPassword"))&&void 0!==a?a:""})})})]})]},"reset-password-form")})},S=function(){var e,r,n,j=(0,v.$)().t,g=(0,p.useState)(null),w=(0,s.Z)(g,2),b=w[0],y=w[1],P=(0,p.useState)(null),C=(0,s.Z)(P,2),q=C[0],S=C[1],M=(0,Z.Z)({onSuccess:function(e,r){null===b||void 0===b||b.updater((function(e){var r;return(0,a.Z)((0,a.Z)({},e),{},{results:(0,l.Z)(null!==(r=null===e||void 0===e?void 0:e.results.map((function(e){return e.id!==b.user.id?e:(0,a.Z)((0,a.Z)({},e),{},{isEnabled:!b.user.isEnabled})})))&&void 0!==r?r:[])})})),y(null)}}),F=(0,s.Z)(M,2),E=F[0],A=F[1];return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(m.Z,{title:j("usersManagement"),id:"user",idProp:"id",EntryForm:N,filterUrl:x.Z.userManager.list,findUrl:function(e){return x.Z.userManager.find(e.id)},columns:[{title:j("fullName"),dataIndex:"fullName",key:"fullName",fixed:"left",render:function(e,r,n){return(0,I.jsx)("span",{children:"".concat(r.firstName," ").concat(r.lastName)})}},{title:j("nationalCode"),dataIndex:"nationalCode",key:"nationalCode"},{title:j("email"),dataIndex:"emailAddress",key:"emailAddress",width:220,render:function(e,r,n){return(0,I.jsx)("a",{href:"mailto:".concat(e),children:e})}},{title:j("baseSalary"),dataIndex:"baseSalary",key:"baseSalary",render:function(e){return(0,I.jsx)(f.Z,{value:e})}},{title:j("organizationLevel"),dataIndex:"organizationLevelName",key:"organizationLevelName",width:200,render:function(e){return(0,I.jsx)("span",{children:e})}},{title:j("enabled"),dataIndex:"enabled",key:"enabled",width:100,render:function(e,r,n){return r.isEnabled?j("yes"):j("no")}}],scrollX:1100,deleteAction:{url:function(e){return x.Z.userManager.delete(e.id)}},addUrl:x.Z.userManager.add,editAction:{url:x.Z.userManager.update},customActions:[{renderer:function(e,r,n,l){var a;return(0,I.jsx)(o.Z,{danger:l?void 0:r.isEnabled,type:l?"ghost":"primary",shape:l?"default":"circle",title:null!==(a=r.isEnabled?j("deactive"):j("activate"))&&void 0!==a?a:"",icon:l?void 0:(0,I.jsx)(h.Z,{name:r.isEnabled?"IoLockClosedOutline":"IoShieldCheckmarkOutline"}),onClick:function(){return y({user:r,updater:n})},children:l?r.isEnabled?j("deactive"):j("activate"):null})}},{renderer:function(e,r,n,l){var a;return(0,I.jsx)(o.Z,{type:l?"ghost":"primary",shape:l?"default":"circle",title:null!==(a=j("resetPasswrod"))&&void 0!==a?a:"",icon:l?void 0:(0,I.jsx)(h.Z,{name:"MdLockReset"}),onClick:function(){return S(r)},children:l?j("resetPassword"):null})}}],entryModalWidth:1e3,children:(0,I.jsx)(i.Z,{gutter:[20,20],children:(0,I.jsx)(d.Z,{xs:24,sm:12,children:(0,I.jsx)(t.Z.Item,{name:"filter",rules:[],children:(0,I.jsx)(u.Z,{placeholder:null!==(e=j("search"))&&void 0!==e?e:""})})})})}),(0,I.jsx)(c.Z,{open:!!b,loading:A,onOk:function(){E.post(x.Z.userManager.changeStatus(b.user.id,!b.user.isEnabled))},title:null!==(r=j("userAccount"))&&void 0!==r?r:"",message:null!==(n=null!==b&&void 0!==b&&b.user.isEnabled?j("areYouSureToDeactive"):j("areYouSureToActivate"))&&void 0!==n?n:"",onCancel:function(){return y(null)}}),q&&(0,I.jsx)(k,{onClose:function(){return S(null)},data:q})]})}}}]);
//# sourceMappingURL=57.df9154c2.chunk.js.map